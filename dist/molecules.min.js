!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.molecules=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}throw new TypeError("Invalid attempt to destructure non-iterable instance")}function f(a){for(var b=void 0===arguments[1]?[]:arguments[1],c=0;c<o.length;c++)for(var d=o[c],e=[];e=d.expression.exec(a);)b.push({index:e.index,type:d.type,term:e[0],tag:d.tag});return b.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),{tokens:b}}function g(a){function b(a){if("object"!=typeof a)return console.log('Error: Tokens must be of type "object"'),!1;void 0!==a.tokens&&(a=a.tokens);for(var b=["index","type","term","tag"],c=0;c<a.length;c++){var d=h(b,Object.keys(a[c]));if(d.reduce(function(a,b){return a+b})<4)return console.log('Error: Invalid token at index "'+c+'"'),!1}return a}function c(a){for(var b=void 0===arguments[1]?{}:arguments[1],c=void 0===arguments[2]?{}:arguments[2],d=void 0===arguments[3]?{}:arguments[3],e=void 0===arguments[4]?{}:arguments[4],f=function(a){return a.toString()},g=0;g<a.length;g++){var h=a[g],k=h.type,l=h.term,m=h.tag,n=h.index,o=f(n);switch(k){case"atom":b[o]=i(o,m,l);break;case"bond":c[o]=j(o,m,l);break;case"property":d[o]={id:o,name:m,value:l}}}if(b.length<1)return console.log("Error: Could not find atoms"),!1;e.all=[];for(var g=0;g<a.length;g++)e.all[g]=f(a[g].index);return e.atoms=Object.keys(b),e.bonds=Object.keys(c),e.properties=Object.keys(d),[b,c,d,e]}function d(a,b){for(var c=0;c<b.atoms.length;c++){var d=b.atoms[c];if(void 0!==n["default"][a[d].name]){var e=n["default"][a[d].name];a[d].group=e.group,a[d].protons=e.protons,a[d].neutrons=e.neutrons,a[d].electrons=e.electrons,a[d].bonds={electrons:0,atoms:[]},a[d].properties={chiral:0,charge:0}}}return a}function f(a,b,c){for(var d=0;d<c.properties.length;d++){var e=c.properties[d],f=b[e],g=f.name,h=f.value;switch(g){case"chiral":if(void 0!==a[e]){a[e].properties.chiral=h.slice(h.indexOf("@"));break}break;case"isotope":var i=h.match(/[0-9]+/g),j=1+i.toString().length+parseInt(e);if(i>0&&250>i&&void 0!==a[j]&&(i-=a[j].protons,i>0)){a[j].neutrons=i;break}break;case"charge":var k=-1!==h.indexOf("+")?1:-1,l=h.match(/(?:[^H])[0-9]+/g);if(null!==l&&void 0!==a[e]){l=l[0].substr(1),a[e].properties.charge=l*k;break}if(l=h.match(/([+]+|[-]+)/g),null!==l&&void 0!==a[e]){a[e].properties.charge=l[0].length*k;break}}}return a}function g(a,b,c){if(0===c.bonds.length||void 0===c.bonds.length)return[a,b,c];for(var d=0;d<c.bonds.length;d++){var e=c.bonds[d],f=a[l(e,c.all,a)],g=a[k(e,c.all,a)],h=c.all.indexOf(e),i=0,j=0;void 0!==f&&null!==f&&(i=c.all.indexOf(f.id)),void 0!==g&&null!==g&&(j=c.all.indexOf(g.id));var m=0;if(j>h&&h>i&&void 0!==b[c.all[h-1]]){var n=b[c.all[h-1]].value,o=b[e].value;")"!==n&&"("!==n||"-"!==o&&"="!==o&&"#"!==o&&"."!==o||(m=1)}switch(b[e].name){case"single":if(1===m)continue;b[e].order=1,b[e].atoms=[f.id,g.id];break;case"double":if(1===m)continue;b[e].order=2,b[e].atoms=[f.id,g.id];break;case"triple":if(1===m)continue;b[e].order=3,b[e].atoms=[f.id,g.id];break;case"dot":if(1===m)continue;break;case"branch":var p=c.all.slice(0,h).reverse(),q=c.all.slice(h+1,c.all.length);switch(b[e].value){case"(":for(var r=0,s=0;r<p.length;r++){if(f=a[p[r]],void 0!==f&&"H"!==f.name&&0===s){b[e].order=1,b[e].atoms=[f.id,g.id];break}if(void 0!==b[p[r]])switch(b[p[r]].value){case")":s++;break;case"(":s--}}for(var r=0,t=1,s=0;r<q.length;r++){if(void 0!==b[q[r]]&&0===s)switch(b[q[r]].value){case"-":t=1;break;case"=":t=2;break;case"#":t=3;break;case".":t=0}if(0===s){b[e].order=t;break}if(void 0!==b[q[r]])switch(b[q[r]].value){case")":s--;break;case"(":s++}}break;case")":for(var r=0,s=1;r<p.length;r++){if(f=a[p[r]],void 0!==f&&"H"!==f.name&&0===s){b[e].order=1,b[e].atoms[0]=f.id;break}if(void 0!==b[p[r]])switch(b[p[r]].value){case")":s++;break;case"(":s--}}for(var r=0,t=1,s=0;r<q.length;r++){if(void 0!==b[q[r]]&&0===s)switch(b[q[r]].value){case"-":t=1;break;case"=":t=2;break;case"#":t=3;break;case".":t=0}if(void 0!==a[q[r]]&&0===s){b[e].order=t,b[e].atoms[1]=a[q[r]].id;break}if(void 0!==b[q[r]])switch(b[q[r]].value){case")":s--;break;case"(":s++}}}break;case"ring":for(var u=b[e].value.match(/[0-9]+/g),v=0,w=c.bonds.slice(c.bonds.indexOf(e),c.bonds.length),r=0;r<w.length;r++)if(!(b[e].atoms.length>0||0===r)){var x=b[w[r]].value.match(/[0-9]+/g);if(null!==u&&null!==x&&u[0]===x[0]){v+=1,b[e].order=1,b[e].atoms=[e,w[r]];break}}}}for(var d=0;d<c.bonds.length;d++)for(var y=c.bonds.slice(d,c.bonds.length),r=0;r<y.length;r++){var e=y[r],z=b[c.bonds[d]],A=b[e];if(void 0!==z&&void 0!==A&&0!==r&&(0===z.atoms.length&&(delete b[c.bonds[d]],delete c.bonds[d]),0===A.atoms.length&&(delete b[e],delete c.bonds[c.bonds.indexOf(e)]),z.atoms[0]===A.atoms[0]&&z.atoms[1]===A.atoms[1])){"ring"===z.name&&"ring"===A.name?(delete b[e],delete c.bonds[c.bonds.indexOf(e)]):"branch"!==z.name||"single"!==A.name&&"double"!==A.name&&"triple"!==A.name?"single"!==z.name&&"double"!==z.name&&"triple"!==z.name||"branch"!==A.name?(delete b[c.bonds[d]],delete c.bonds[d]):(delete b[e],delete c.bonds[c.bonds.indexOf(e)]):(delete b[c.bonds[d]],delete c.bonds[d]),d--;break}}for(var d=0;d<c.bonds.length;d++)void 0===c.bonds[d]&&(c.bonds.splice(d,1),d--);for(var d=0;d<c.bonds.length;d++){var e=c.bonds[d],B=b[e].atoms[0],x=b[e].atoms[1];void 0!==B&&void 0!==x&&(a[B].bonds.atoms.push(x),a[x].bonds.atoms.push(B),a[B].bonds.electrons+=b[e].order,a[x].bonds.electrons+=b[e].order)}return[a,b,c]}function m(a,b,c){for(var d=0;d<c.atoms.length;d++)if(c.atoms.length!==d+1){var e=a[c.atoms[d]],f=a[c.atoms[d+1]],g=18,h=18;e.group<=2?g=2:e.group<13&&e.group>3&&(g=12),f.group<=2?h=2:f.group<13&&f.group>3&&(h=12);var k=g-e.group-e.bonds.electrons,l=h-f.group-f.bonds.electrons;if(18===g&&e.protons>10&&e.bonds.electrons>4&&0>=k&&(k+=4),18===h&&f.protons>10&&f.bonds.electrons>4&&0>=l&&(l+=4),e.properties.charge>0&&(k-=e.properties.charge),f.properties.charge>0&&(l-=f.properties.charge),!(0>=k||0>=l)&&-1===e.bonds.atoms.indexOf(f.id)){var m=c.all.indexOf(f.id)-c.all.indexOf(e.id),o=0;if(m>1)for(var p=c.all.slice(c.all.indexOf(e.id)+1,c.all.indexOf(f.id)),q=0;q<p.length;q++)void 0!==b[p[q]]&&"ring"!==b[p[q]].name&&(o=1);if(0===o){var r=e.name+e.id+(f.name+f.id),s=e.name+f.name;c.bonds.push(r),b[r]=j(r,"single",s,1,[e.id,f.id]),a[e.id].bonds.atoms.push(f.id),a[f.id].bonds.atoms.push(e.id),a[e.id].bonds.electrons+=1,a[f.id].bonds.electrons+=1}}}for(var t=n["default"].H,d=0;d<c.atoms.length;d++){var e=a[c.atoms[d]];if(!(e.group<13)){for(var u=e.bonds.atoms.length,q=0;u>q;q++){var v=e.bonds.atoms[q],f=a[v];if("H"===f.name){var w=parseInt(f.value.match(/[0-9]+/g));if(w>1&&w<e.electrons)for(var x=0;w-1>x;x++){var r="H"+(x+1)+e.name+e.id,s=e.name+"H";a[r]=i(r,"H","H",t.group,t.protons,t.neutrons,t.electrons),b[r]=j(r,"hydrogen",s,1,[e.id,r]),a[e.id].bonds.atoms.push(r),a[r].bonds.atoms.push(e.id),a[e.id].bonds.electrons+=1,a[r].bonds.electrons+=1}}}var k=18-e.group-e.bonds.electrons;if(!(0>=k||(e.properties.charge>0?k-=e.properties.charge:e.properties.charge<0&&(k+=e.properties.charge,1===k&&(k-=1,a[e.id].bonds.electrons+=1)),0>=k)))for(var q=0;k>q;q++){var r="H"+(q+1)+e.name+e.id,s=e.name+"H";a[r]=i(r,"H","H",t.group,t.protons,t.neutrons,t.electrons),b[r]=j(r,"hydrogen",s,1,[e.id,r]),a[e.id].bonds.atoms.push(r),a[r].bonds.atoms.push(e.id),a[e.id].bonds.electrons+=1,a[r].bonds.electrons+=1}}}return[a,b,c]}var o=void 0,p=void 0,q=void 0,r=void 0;if(a=b(a),!a)return!1;var s=c(a),t=e(s,4);o=t[0],p=t[1],q=t[2],r=t[3],o=d(o,r),o=f(o,q,r);var u=g(o,p,r),v=e(u,3);o=v[0],p=v[1],r=v[2];var w=m(o,p,r),x=e(w,3);return o=x[0],p=x[1],r=x[2],{atoms:o,bonds:p}}function h(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=b.indexOf(a[d])>-1?1:0;return c}function i(a,b,c){var d=void 0===arguments[3]?0:arguments[3],e=void 0===arguments[4]?0:arguments[4],f=void 0===arguments[5]?0:arguments[5],g=void 0===arguments[6]?0:arguments[6];return{id:a,name:b,value:c,group:d,protons:e,neutrons:f,electrons:g,bonds:{electrons:0,atoms:[]},properties:{chiral:0,charge:0}}}function j(a,b,c){var d=void 0===arguments[3]?0:arguments[3],e=void 0===arguments[4]?[]:arguments[4];return{id:a,name:b,value:c,order:d,atoms:e}}function k(a,b,c){var d=b.indexOf(a);if(-1===d)return null;b=b.slice(d,b.length);for(var e=1;e<b.length;e++)if(void 0!==c[b[e]])return b[e];return null}function l(a,b,c){if("0"===a&&void 0!==c[0])return"0";var d=b.indexOf(a);if(-1===d)return null;b=b.slice(0,d).reverse();for(var e=0;e<b.length;e++)if(void 0!==c[b[e]])return b[e];return null}Object.defineProperty(c,"__esModule",{value:!0});var m=a("./../reference/elements"),n=d(m),o=[{type:"atom",term:"H",tag:"H",expression:/(?=[A-Z])H(?=[^efgos]|$)([0-9]?)+/g},{type:"atom",term:"B",tag:"B",expression:/B(?=[^aehikr]|$)/g},{type:"atom",term:"C",tag:"C",expression:/C(?=[^adeflmnorsu]|$)/g},{type:"atom",term:"N",tag:"N",expression:/N(?=[^abdeiop]|$)/g},{type:"atom",term:"O",tag:"O",expression:/O(?=[^s]|$)/g},{type:"atom",term:"F",tag:"F",expression:/F(?=[^elmr]|$)/g},{type:"atom",term:"Ne",tag:"Ne",expression:/Ne/g},{type:"atom",term:"Na",tag:"Na",expression:/Na/g},{type:"atom",term:"Mg",tag:"Mg",expression:/Mg/g},{type:"atom",term:"Si",tag:"Si",expression:/Si/g},{type:"atom",term:"Al",tag:"Al",expression:/Al/g},{type:"atom",term:"P",tag:"P",expression:/P(?=[^abdmortu]|$)/g},{type:"atom",term:"S",tag:"S",expression:/S(?=[^bcegimnr]|$)/g},{type:"atom",term:"Cl",tag:"Cl",expression:/Cl/g},{type:"atom",term:"Se",tag:"Se",expression:/Se/g},{type:"atom",term:"Br",tag:"Br",expression:/Br/g},{type:"atom",term:"I",tag:"I",expression:/I(?=[^nr]|$)/g},{type:"atom",term:"*",tag:"*",expression:/[*]/g},{type:"atom",term:"b",tag:"B",expression:/b(?=[^e]|$)/g},{type:"atom",term:"c",tag:"C",expression:/c(?=[^l]|$)/g},{type:"atom",term:"n",tag:"N",expression:/n(?=[^ae]|$)/g},{type:"atom",term:"o",tag:"O",expression:/o(?=[^s]|$)/g},{type:"atom",term:"p",tag:"P",expression:/p/g},{type:"atom",term:"s",tag:"S",expression:/s(?=[^ei]|$)/g},{type:"atom",term:"se",tag:"Se",expression:/se/g},{type:"bond",term:"-",tag:"single",expression:/(?=([^0-9]))[-](?=[^0-9-\]])/g},{type:"bond",term:"=",tag:"double",expression:/[=]/g},{type:"bond",term:"#",tag:"triple",expression:/[#]/g},{type:"bond",term:"(",tag:"branch",expression:/[(]/g},{type:"bond",term:")",tag:"branch",expression:/[)]/g},{type:"bond",term:"%",tag:"ring",expression:/(?=[^+-])(?:[a-zA-Z]|[a-zA-Z]*.?[\]])[%]?\d(?=([^+-]|$))/g},{type:"bond",term:".",tag:"dot",expression:/(?:[A-Z][+-]?[\[])?[.]/g},{type:"property",term:"+",tag:"charge",expression:/[a-zA-Z]{1,2}[0-9]*[+]+[0-9]*(?=[\]])/g},{type:"property",term:"-",tag:"charge",expression:/[a-zA-Z]{1,2}[0-9]*[-]+[0-9]*(?=[\]])/g},{type:"property",term:"n",tag:"isotope",expression:/(?:[\[])[0-9]+[A-Z]{1,2}(?=.?[^\[]*[\]])/g},{type:"property",term:"@",tag:"chiral",expression:/[A-Z][a-z]?[@](?![A-Z]{2}[0-9]+|[@])/g},{type:"property",term:"@@",tag:"chiral",expression:/[A-Z][a-z]?[@]{2}(?![A-Z]{2}[0-9]+)/g}];c.tokenize=f,c.decode=g,c.grammar=o},{"./../reference/elements":3}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=void 0===arguments[1]?"SMILES":arguments[1];switch(b){case"SMILES":case"smiles":return"string"==typeof a?l.tokenize(a):"object"==typeof a?l.decode(a):null}}function f(a){void 0===arguments[1]?"SMILES":arguments[1];return"string"==typeof a?l.tokenize(a):null}function g(a){if(a.length>1){var b=l.decode(a),c=b.atoms,d=b.bonds,e=h(c,d,0,"0");return e.properties.mass=j(e.atoms),e.properties.formula=i(e.atoms),e}return null}function h(){var a=void 0===arguments[0]?{}:arguments[0],b=void 0===arguments[1]?{}:arguments[1],c=void 0===arguments[2]?0:arguments[2],d=void 0===arguments[3]?"":arguments[3];return{id:c,name:d,atoms:a,bonds:b,properties:{mass:null,formula:null}}}function i(a){for(var b={},c=Object.keys(a),d=0;d<c.length;d++)void 0===b[a[c[d]].name]?b[a[c[d]].name]=1:b[a[c[d]].name]+=1;return b}function j(a){for(var b=0,c=Object.keys(a),d=0;d<c.length;d++)b+=a[c[d]].protons+a[c[d]].neutrons;return Math.round(1e3*b)/1e3}Object.defineProperty(c,"__esModule",{value:!0});var k=a("./reference/elements"),l=(d(k),a("./encoding/smiles"));c.parse=e,c.getTokens=f,c.readTokens=g,c.molecularFormula=i,c.molecularWeight=j},{"./encoding/smiles":1,"./reference/elements":3}],3:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={H:{protons:1,neutrons:.0079,electrons:1,group:1,period:1},He:{protons:2,neutrons:2.0026,electrons:2,group:18,period:1},Li:{protons:3,neutrons:3.941,electrons:3,group:1,period:2},Be:{protons:4,neutrons:5.0122,electrons:4,group:2,period:2},B:{protons:5,neutrons:5.811,electrons:5,group:13,period:2},C:{protons:6,neutrons:6.0107,electrons:6,group:14,period:2},N:{protons:7,neutrons:7.0067,electrons:7,group:15,period:2},O:{protons:8,neutrons:7.9994,electrons:8,group:16,period:2},F:{protons:9,neutrons:9.9984,electrons:9,group:17,period:2},Ne:{protons:10,neutrons:10.1797,electrons:10,group:18,period:2},Na:{protons:11,neutrons:11.9897,electrons:11,group:1,period:3},Mg:{protons:12,neutrons:12.305,electrons:12,group:2,period:3},Al:{protons:13,neutrons:13.9815,electrons:13,group:13,period:3},Si:{protons:14,neutrons:14.0855,electrons:14,group:14,period:3},P:{protons:15,neutrons:15.9738,electrons:15,group:15,period:3},S:{protons:16,neutrons:16.065,electrons:16,group:16,period:3},Cl:{protons:17,neutrons:18.453,electrons:17,group:17,period:3},Ar:{protons:18,neutrons:21.948,electrons:18,group:18,period:3},Se:{protons:34,neutrons:44.96,electrons:34,group:16,period:4},Br:{protons:35,neutrons:44.904,electrons:35,group:17,period:4},I:{protons:53,neutrons:73.9045,electrons:53,group:17,period:5}};c["default"]=d,b.exports=c["default"]},{}]},{},[2])(2)});